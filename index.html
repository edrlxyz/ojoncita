<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Â¿SerÃ¡s mi ValentÃ­n?</title>

  <style>
    :root { --yesScale: 1; }

    * { box-sizing: border-box; }

    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 55%, #fecfef 100%);
      overflow:hidden;
    }

    .card{
      width:min(760px, 94vw);
      padding:24px 18px 18px;
      border-radius:24px;
      background: rgba(255,255,255,0.15);
      box-shadow: 0 12px 40px rgba(0,0,0,0.18);
      backdrop-filter: blur(6px);
      text-align:center;
      position: relative;
      z-index: 2;
    }

    .top-img{
      width: 260px;
      max-width: 72vw;
      height:auto;
      border-radius:18px;
      box-shadow: 0 10px 26px rgba(0,0,0,0.25);
      display:block;
      margin: 4px auto 16px;
      user-select:none;
      -webkit-user-drag:none;
    }

    h1{
      margin: 8px 0 14px;
      color:#ffffff;
      text-shadow: 0 2px 10px rgba(0,0,0,0.25);
      font-size: clamp(1.6rem, 4.5vw, 2.3rem);
      font-weight: 800;
    }

    .arena{
      position:relative;
      width:min(720px, 90vw);
      height: 190px;
      margin: 0 auto;
      overflow: visible;
    }

    button{
      border:0;
      padding: 14px 26px;
      border-radius: 999px;
      font-size: 1.25rem;
      cursor: pointer;
      box-shadow: 0 8px 18px rgba(0,0,0,0.18);
      transition: transform 160ms ease, filter 160ms ease;
      user-select:none;
      will-change: transform;
    }

    #yes{
      position:absolute;
      left: 30%;
      top: 105px;
      transform: translateX(-50%) scale(var(--yesScale));
      transform-origin: center;
      background: linear-gradient(45deg, #ff6b6b, #ee5a24);
      color:#fff;
      z-index: 2;
    }

    #no{
      position:absolute;
      left: 70%;
      top: 105px;
      background: linear-gradient(45deg, #cfd6da, #9aa5ad);
      color:#2f2f2f;
      z-index: 1;

      /* Nunca clickeable */
      pointer-events: none;
    }

    #msg{
      min-height: 26px;
      margin-top: 8px;
      color:#ffffff;
      text-shadow: 0 2px 10px rgba(0,0,0,0.25);
      font-size: 1.05rem;
    }

    /* Overlay de la carta */
    .overlay{
      position: fixed;
      inset: 0;
      display:none;
      align-items: center;
      justify-content: center;
      padding: 22px 14px;
      background: rgba(0,0,0,0.55);
      z-index: 50;
    }

    .overlay.show{ display:flex; }

    .letter{
      width: min(980px, 96vw);
      height: min(92vh, 820px);
      border-radius: 18px;
      background: rgba(255,255,255,0.92);
      box-shadow: 0 14px 50px rgba(0,0,0,0.35);
      padding: 22px 18px;
      overflow: auto;

      /* Tu fuente */
      font-family: "Maiandra GD", "Maiandra", "Segoe UI", Arial, sans-serif;
      line-height: 1.45;
      color: #1f1f1f;
      text-align: left;
      font-size: 20px;
      white-space: pre-wrap;
    }

    @media (max-width: 520px){
      .arena{ height: 220px; }
      #yes, #no{ top: 125px; }
      button{ font-size: 1.1rem; padding: 12px 22px; }
      .letter{ font-size: 17px; }
    }

    /* =========================
       LLUVIA DE CORAZONES (LADOS)
       ========================= */

    #hearts-layer{
      position: fixed;
      inset: 0;
      overflow: hidden;
      pointer-events: none; /* no bloquea clicks */
      z-index: 1;          /* detrÃ¡s de la card (que tiene z-index:2) */
    }

    .heart{
      position: absolute;
      top: -28px;
      user-select: none;
      will-change: transform, opacity;
      animation-name: heart-fall;
      animation-timing-function: linear;
      animation-fill-mode: forwards;
      filter: drop-shadow(0 10px 14px rgba(0,0,0,.15));
    }

    @keyframes heart-fall{
      0%   { transform: translate3d(0, -24px, 0) rotate(0deg); opacity: 0; }
      10%  { opacity: 1; }
      100% { transform: translate3d(var(--drift), 105vh, 0) rotate(var(--rot)); opacity: 0; }
    }
  </style>
</head>

<body>
  <!-- Capa para la lluvia -->
  <div id="hearts-layer" aria-hidden="true"></div>

  <main class="card">
    <img
      class="top-img"
      src="https://i.pinimg.com/736x/84/f3/3c/84f33c2acf4bbb5ea69ff80957c6afc3.jpg"
      alt="Imagen"
    />
    <h1>Â¿SerÃ¡s mi ValentÃ­n? ðŸ’•</h1>

    <section class="arena" id="arena">
      <button id="yes">SÃ­</button>
      <button id="no" aria-hidden="true">No</button>
    </section>

    <div id="msg"></div>
  </main>

  <div class="overlay" id="overlay">
    <div class="letter" id="letter"></div>
  </div>

  <script>
    const arena = document.getElementById('arena');
    const noBtn = document.getElementById('no');
    const yesBtn = document.getElementById('yes');
    const msg = document.getElementById('msg');
    const overlay = document.getElementById('overlay');
    const letter = document.getElementById('letter');

    let started = false;
    let growTimer = null;
    let yesScale = 1;

    const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

    function ensureNoHasPosition() {
      const left = parseFloat(noBtn.style.left);
      const top = parseFloat(noBtn.style.top);
      if (Number.isNaN(left) || Number.isNaN(top)) {
        noBtn.style.left = noBtn.offsetLeft + 'px';
        noBtn.style.top = noBtn.offsetTop + 'px';
      }
    }

    function pointerInsideRect(x, y, rect){
      return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;
    }

    function startGrowing() {
      if (started) return;
      started = true;

      // Crecimiento rÃ¡pido y sin lÃ­mite (exponencial)
      growTimer = setInterval(() => {
        yesScale = yesScale * 1.18;
        document.documentElement.style.setProperty('--yesScale', yesScale.toFixed(4));
      }, 300);
    }

    function moveNoAway(pointerX, pointerY) {
      ensureNoHasPosition();

      const arenaRect = arena.getBoundingClientRect();
      const btnRect = noBtn.getBoundingClientRect();

      const mouseX = pointerX - arenaRect.left;
      const mouseY = pointerY - arenaRect.top;

      const btnCenterX = (btnRect.left - arenaRect.left) + btnRect.width / 2;
      const btnCenterY = (btnRect.top - arenaRect.top) + btnRect.height / 2;

      const dx = btnCenterX - mouseX;
      const dy = btnCenterY - mouseY;

      const dist = Math.hypot(dx, dy);

      // Sensor mÃ¡s pequeÃ±o para que no se altere al clicar "SÃ­"
      const triggerDist = 85;
      if (dist > triggerDist) return;

      const ux = dx / (dist || 1);
      const uy = dy / (dist || 1);

      const step = 170;

      const curLeft = parseFloat(noBtn.style.left);
      const curTop = parseFloat(noBtn.style.top);

      const maxLeft = arena.clientWidth - noBtn.offsetWidth;
      const maxTop = arena.clientHeight - noBtn.offsetHeight;

      let nextLeft = curLeft + ux * step;
      let nextTop = curTop + uy * step;

      nextLeft = clamp(nextLeft, 0, maxLeft);
      nextTop = clamp(nextTop, 0, maxTop);

      // Si por el clamp queda cerca, reubicar lejos
      const nextCenterX = nextLeft + noBtn.offsetWidth / 2;
      const nextCenterY = nextTop + noBtn.offsetHeight / 2;
      if (Math.hypot(nextCenterX - mouseX, nextCenterY - mouseY) < 150) {
        for (let i = 0; i < 12; i++) {
          const rLeft = Math.random() * maxLeft;
          const rTop = Math.random() * maxTop;
          const rCenterX = rLeft + noBtn.offsetWidth / 2;
          const rCenterY = rTop + noBtn.offsetHeight / 2;
          if (Math.hypot(rCenterX - mouseX, rCenterY - mouseY) > 210) {
            nextLeft = rLeft; nextTop = rTop;
            break;
          }
        }
      }

      noBtn.style.left = nextLeft + 'px';
      noBtn.style.top = nextTop + 'px';
    }

    const letterText =
`Mayra.
SabÃ­as que hay una fuente de texto que se llama Maiandra GD. Suena como una fusiÃ³n de Mayra Alejandra, entonces decidÃ­ usarla en este texto. El GD puede significar la verdad cualquier cosa, dejÃ©moslo a nuestra imaginaciÃ³n. De pronto puede ser Gil DurÃ¡n, como tu amiga; GuzmÃ¡n DurÃ¡n, como el Chapo; o puede ser otra cosa aparte de apellidos: Gamer Destroyer. Si fueras friki y youtuber, Gran Diosa. Yo creo que ese te pega. Â¿Gata DramÃ¡tica? En fin, hay muchÃ­simas combinaciones.
Siento que asÃ­ como el GD estÃ¡ en todas esas combinaciones, o asÃ­ como tu nombre lo tropiezo en una lista de tipografÃ­as, te encuentro tan seguido en mi dÃ­a a dÃ­a, pues te pienso mÃ¡s de lo que pienso. Â¿SabÃ­as que mientras el consciente solo puede tener un pensamiento a la vez, el subconsciente de encarga de todo el resto? De respirar, estar alerta, filtrar ideas para que lleguen adelante; y, en mi caso, en pensarte, pues incluso cuando no soy consciente, te veo. De eso se trata tenerte, supongo: habitas algo indescriptible en mÃ­, te llevo siempre conmigo, eres mi mejor sentido.
Me avergÃ¼enzan mis recaÃ­das. No me siento el justo para escribirte hoy textos, pero quiero. Â¿Me verÃ© loco si digo algo una vez y demuestro su opuesto? Se me cae la cara de vergÃ¼enza, pero escribo para solo pensar en lo bueno. Y oh, mi amada, si de lo bueno hablamos; oh, vida, me siento en dicha.
Y cuando estamos bien, no solo te amo a ti, es mÃ¡s lo que amo: amo la existencia que tÃº me otorgas.
Gracias por soportarme, gracias por ser tÃº, gracias por ser mi novia, gracias por ser mi amiga, gracias por corresponderme, gracias por ser mi San Valentine. Gracias, Divina. GD.
-Edward`;

    // Pointermove: crecer + huir, pero NO huir si el puntero estÃ¡ sobre "SÃ­"
    document.addEventListener('pointermove', (e) => {
      startGrowing();

      const yesRect = yesBtn.getBoundingClientRect();
      if (pointerInsideRect(e.clientX, e.clientY, yesRect)) return;

      moveNoAway(e.clientX, e.clientY);
    }, { passive: true });

    yesBtn.addEventListener('click', () => {
      if (growTimer) clearInterval(growTimer);

      // Mostrar carta en overlay a pantalla completa
      letter.textContent = letterText;
      overlay.classList.add('show');

      // Ocultar botones
      yesBtn.style.display = 'none';
      noBtn.style.display = 'none';
      msg.textContent = '';
    });

    // Cerrar overlay al hacer click fuera del texto (opcional)
    overlay.addEventListener('click', (e) => {
      if (e.target === overlay) overlay.classList.remove('show');
    });

    window.addEventListener('load', () => ensureNoHasPosition());

    /* =========================
       JS: LLUVIA SOLO EN LOS LADOS
       ========================= */
    const heartsLayer = document.getElementById('hearts-layer');
    const card = document.querySelector('.card');

    function rand(min, max){ return Math.random() * (max - min) + min; }
    function pick(arr){ return arr[Math.floor(Math.random() * arr.length)]; }

    function sideRanges() {
      const w = window.innerWidth;
      const rect = card.getBoundingClientRect();

      const leftMax = Math.max(0, rect.left);
      const rightMin = Math.min(w, rect.right);

      const leftWidth = leftMax;
      const rightWidth = w - rightMin;

      return { w, leftMax, rightMin, leftWidth, rightWidth };
    }

    function spawnHeart() {
      if (!card) return;

      const { w, leftMax, rightMin, leftWidth, rightWidth } = sideRanges();
      const hasLeft = leftWidth > 20;
      const hasRight = rightWidth > 20;
      if (!hasLeft && !hasRight) return;

      const side = (hasLeft && hasRight)
        ? (Math.random() < 0.5 ? 'L' : 'R')
        : (hasLeft ? 'L' : 'R');

      const x = side === 'L' ? rand(0, leftMax) : rand(rightMin, w);

      const el = document.createElement('div');
      el.className = 'heart';
      el.textContent = pick(['â¤','â™¥','ðŸ’—','ðŸ’–']);

      const size = rand(12, 26);
      const duration = rand(3.5, 7.5);
      const drift = rand(-30, 30);
      const rot = rand(-180, 180);

      el.style.left = `${x}px`;
      el.style.fontSize = `${size}px`;
      el.style.animationDuration = `${duration}s`;
      el.style.setProperty('--drift', `${drift}px`);
      el.style.setProperty('--rot', `${rot}deg`);
      el.style.opacity = rand(0.7, 1);

      el.style.color = pick(['#ff4d6d','#ff758f','#ff8fab','#ff2d55','#ff5c8a']);

      heartsLayer.appendChild(el);
      el.addEventListener('animationend', () => el.remove());
    }

    // Densidad (ajÃºstala si quieres mÃ¡s/menos)
    const heartTimer = setInterval(() => {
      const n = Math.random() < 0.35 ? 2 : 1;
      for (let i = 0; i < n; i++) spawnHeart();
    }, 350);

    // Opcional: pausa la lluvia cuando se abre la carta
    // (comenta este bloque si quieres que siga lloviendo)
    const originalShow = overlay.classList.add.bind(overlay.classList);
    overlay.classList.add = function(...args){
      if (args.includes('show')) clearInterval(heartTimer);
      return originalShow(...args);
    };
  </script>
</body>
</html>
